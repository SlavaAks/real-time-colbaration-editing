/*3 е задание */
Select  Преподаватель.Кафедра, Преподаватель.фамилия, Count(Оценки.оценка) INTO ##СвояТаблица FROM Преподаватель JOIN Оценка ON Преподаватель.Код_преподавателя=Оценка.Код_преподавателя Where Оценки.Оценка<4;
/*2 е*/
Select кафедра, count(должность) AS доцент FROM преподаватели WHERE должность = доцент GRUOP BY кафедра
join SELECT кафедра, COUNT(должность) AS ассистент INTO ## ассистент_таблица FROM преподаватель WHERE должность = ассистент GRUOP BY кафедра
join SELECT кафедра, COUNT(должность) AS профессор INTO ## профессор_таблица FROM преподаватель WHERE должность = профессор GRUOP BY кафедра
join SELECT кафедра, COUNT(должность) AS старший преподаватель INTO ## старший преподаватель_таблица FROM преподаватель WHERE должность = старший преподаватель GRUOP BY кафедра;
/*4*/
update
студенты
set студенты.размер стипендии = 1.2*студенты.размер стипендии
where Студенты.Код_студента = (SELECT Студенты.Код_студента
FROM Студенты INNER JOIN оценки ON Студенты.Код_студента = Оценки.Код_студента
GROUP BY Студенты.Код_студента
HAVING Avg(Оценки.Оценка)>(SELECT Avg(Оценки.Оценка) AS СредБаллОбщ FROM Оценки));
/*вариант 20*/